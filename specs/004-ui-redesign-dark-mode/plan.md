# Implementation Plan: UI Redesign with Dark Mode

**Branch**: `004-ui-redesign-dark-mode` | **Date**: November 5, 2025 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/004-ui-redesign-dark-mode/spec.md`

## Summary

This feature implements a comprehensive UI redesign with three key components: (1) a new landing page with hero and features sections, (2) full dark mode support with theme toggle and system preference detection using next-themes library, and (3) a visual refresh with a sleek, minimal, playful aesthetic using rounded corners and vibrant accent colors. The implementation will update the existing Tailwind CSS theme with the provided OKLCH color palette, integrate next-themes for robust theme management, build a new landing page at the root URL, add a theme toggle in the header, and audit/simplify existing animations to retain only purposeful micro-interactions.

## Technical Context

**Language/Version**: TypeScript 5+, Node.js 18+, Next.js 16.0.1, React 19.2.0  
**Primary Dependencies**: Next.js, React, Tailwind CSS 4.0, shadcn/ui, @clerk/nextjs (auth), Socket.IO client, next-themes (theme management)  
**Storage**: Browser localStorage via next-themes (theme preference only - no backend changes)  
**Testing**: NONE (per constitution - no testing infrastructure)  
**Target Platform**: Web (responsive: mobile 320px+ to desktop 2560px+)  
**Project Type**: Next.js App Router (apps/frontend/)  
**Performance Goals**: <2s landing page load on 4G, <100ms theme switching, 60fps animations  
**Constraints**: <500KB additional bundle size, maintain WCAG 2.1 AA contrast (4.5:1), support reduced motion preferences  
**Scale/Scope**: 5 major pages (landing, lobby, game room, groups, leaderboard), ~15-20 components to update, new theme system with 40+ CSS variables

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

- [x] **Clean Code**: Feature maintains clean code through component composition, clear naming, and minimal complexity
- [x] **Simple & Elegant UI**: Landing page and theme toggle follow simple, intuitive patterns; minimal aesthetic reduces visual complexity
- [x] **Responsive Design**: Explicitly required responsive design 320px-2560px with touch targets and mobile-first approach
- [x] **Minimal Dependencies**: One new dependency (next-themes 0.4KB gzipped) - well-established, battle-tested library that simplifies theme management and prevents FOUC
- [x] **No Testing**: Confirmed - no test infrastructure planned, quality assured through manual testing
- [x] **Next.js + Tailwind + shadcn/ui**: Implementation uses required tech stack exclusively

**Complexity Justifications**: 
- **next-themes dependency**: Justified because it's industry-standard (30M+ downloads/month), prevents flash of unstyled content (FOUC), handles edge cases (SSR, system preference detection), and is only 0.4KB gzipped. Alternative of custom implementation would be more complex and error-prone.

## Project Structure

### Documentation (this feature)

```text
specs/004-ui-redesign-dark-mode/
├── plan.md              # This file
├── research.md          # Phase 0: Dark mode patterns, animation audit, landing page best practices
├── data-model.md        # Phase 1: Theme preference storage schema
├── quickstart.md        # Phase 1: Setup and testing guide
├── contracts/           # Phase 1: Not applicable (frontend-only feature)
├── tasks.md             # Phase 2: Generated by /speckit.tasks
└── checklists/
    └── requirements.md  # Quality checklist (completed)
```

### Source Code (repository root)

```text
apps/frontend/
├── app/
│   ├── (marketing)/           # NEW: Route group for landing page
│   │   ├── page.tsx          # NEW: Landing page (hero + features)
│   │   └── components/       # NEW: Landing page components
│   │       ├── hero.tsx
│   │       ├── features.tsx
│   │       └── cta-buttons.tsx
│   ├── components/           # Existing components to update
│   │   ├── navigation.tsx    # UPDATE: Add theme toggle
│   │   ├── loading.tsx       # UPDATE: Simplify animations
│   │   ├── winner-banner.tsx # UPDATE: Remove animate-bounce
│   │   └── participant-card.tsx # UPDATE: Reduce animations
│   ├── providers/
│   │   ├── theme-provider.tsx # NEW: Theme context + localStorage
│   │   └── query-provider.tsx # Existing
│   ├── globals.css           # UPDATE: Replace with new OKLCH theme
│   ├── layout.tsx            # UPDATE: Wrap with ThemeProvider
│   └── [other existing routes]
├── components/ui/            # shadcn/ui components
│   ├── theme-toggle.tsx      # NEW: Moon/sun toggle button
│   └── [existing components] # UPDATE: Verify dark mode compatibility
└── public/
    ├── horizontal-logo-light.png # Existing
    └── square-logo-light.png     # Existing
```

**Structure Decision**: Using Next.js App Router with route groups for marketing pages. The `(marketing)` route group will house the new landing page, keeping it separate from authenticated/game routes. Theme will be managed using next-themes library (industry-standard, prevents FOUC) at the root layout level to ensure theme context is available throughout the app. All styling changes will be centralized in `globals.css` using the provided OKLCH color palette.

## Complexity Tracking

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| Adding next-themes dependency | Prevents FOUC, handles SSR edge cases, system preference detection, localStorage management | Custom implementation would be 200+ lines of complex code with potential bugs, FOUC issues, and SSR hydration mismatches. next-themes is battle-tested (30M+ downloads/month), only 0.4KB gzipped, and is the industry standard for Next.js theme management. |
